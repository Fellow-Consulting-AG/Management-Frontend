var S=Object.defineProperty;var A=(a,e,t)=>e in a?S(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var d=(a,e,t)=>(A(a,typeof e!="symbol"?e+"":e,t),t);import{k as x,U as F,V as T,c as E,h as j,C as P,O as L,W as h}from"./index.d19697de.js";import{a as v}from"./axios.ab682c6b.js";import{g as U,a as C,P as i}from"./helperMixin.e09d473f.js";var ae=x({name:"QCardActions",props:{...F,vertical:Boolean},setup(a,{slots:e}){const t=T(a),s=E(()=>`q-card__actions ${t.value} q-card__actions--${a.vertical===!0?"vert column":"horiz row"}`);return()=>j("div",{class:s.value},P(e.default))}});const D=L.has.webStorage===!1?U():C("session"),g={install({$q:a}){a.sessionStorage=D}};Object.assign(g,D);var O={methods:{logout(){this.clearStorageForLogout(),window.location.href="/"},clearStorageForLogout(){k().$reset(),i.remove("token_deatils"),i.remove("session_id"),i.remove("after_login_route"),i.remove("user_details"),i.remove("user_settings"),i.remove("doc_types"),i.remove("fields_sep_comp"),i.remove("login_source"),i.remove("verify_email"),i.remove("image_field_splitter"),g.clear()},clearStorageForRefresh(){g.remove("sub_org_id"),g.remove("doc_types_sub_types"),g.remove("organizations"),g.remove("acls"),g.remove("sub_app"),g.remove("sub_types")},setDataToLocalStorage(a,e){return i.set(a,e)},getDataByKey(a){return i.getItem(a)}}};class f extends Error{constructor(t){super();d(this,"metadata");d(this,"success",!1);d(this,"message","");d(this,"status","");this.metadata=t,this.convertError(),this.handleApiKeyError()}convertError(){this.status="",this.success=!1,this.message="",!(!this.metadata.hasOwnProperty("response")||!this.metadata.response)&&(this.metadata.response.hasOwnProperty("status")&&(this.status=this.metadata.response.status),this.metadata.response.hasOwnProperty("data")&&(this.metadata.response.data.hasOwnProperty("success")&&(this.success=this.metadata.response.data.success),this.metadata.response.data.hasOwnProperty("message")&&(this.message=this.metadata.response.data.message),this.metadata.response.data.hasOwnProperty("error_description")&&(this.message=this.metadata.response.data.error_description)))}handleApiKeyError(){this.message.toLowerCase().includes("invalid key")&&O.methods.logout()}}class R extends Error{constructor(t){super();d(this,"metadata");d(this,"success",!1);d(this,"message","");d(this,"status","");this.metadata=t,this.convertError()}convertError(){this.status="cancelled",this.success=!1,this.message="cancelled"}}const q=v.CancelToken;function z(a){const e={},t={cancelToken:null};return e[a]={handleRequestCancellation:()=>(t.cancelToken&&t.cancelToken.cancel(a),t.cancelToken=q.source(),t.cancelToken)},e}const I=z("doc2app");class H{constructor(e){d(this,"client");this.client=v.create({...e}),this.client.defaults.headers.common.Accept="application/json;charset=UTF-8",this.client.defaults.headers.common["Content-Type"]="application/json;charset=UTF-8"}async post(e,t,s){try{const r=s?await this.client.post(e,t,s):await this.client.post(e,t);return this.handleResponse(r)}catch(r){if(s&&s.hasOwnProperty("error")){const o=s.error;return o&&o.call(this,r),{}}this.handleError(r)}return{}}async postWithCancel(e,t,s){try{console.info("postWithCancel",e),s.cancelToken=I[e].handleRequestCancellation().token;const r=s?await this.client.post(e,t,s):await this.client.post(e,t);return this.handleResponse(r)}catch(r){if(s&&s.hasOwnProperty("error")){const o=s.error;return o&&o.call(this,r),{}}this.handleError(r)}return{}}async put(e,t,s){try{const r=s?await this.client.put(e,t,s):await this.client.put(e,t);return this.handleResponse(r)}catch(r){if(s&&s.hasOwnProperty("error")){const o=s.error;return o&&o.call(this,r),{}}this.handleError(r)}return{}}async get(e,t){try{const s=await this.client.get(e,t);return this.handleResponse(s)}catch(s){if(t&&t.hasOwnProperty("error")){const r=t.error;return r&&r.call(this,s),{}}this.handleError(s)}return{}}async delete(e,t){try{const s=t?await this.client.delete(e,t):await this.client.delete(e);return this.handleResponse(s)}catch(s){this.handleError(s)}return{}}createParams(e){const t=new URLSearchParams;for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];r!=null?t.append(s,r):console.debug(`Param key '${s}' was null or undefined and will be ignored`)}return t}handleResponse(e){return e.data}isAxiosError(e){return typeof(e==null?void 0:e.response)=="object"}handleError(e){if(e instanceof Error)if(this.isAxiosError(e)){if(e.response)throw e.response.status&&e.response.status===503&&(this.logErrorMessage(e.response),window.location.href="/network_error"),e.response.status&&e.response.status===401&&O.methods.logout(),new f(e);if(e.request)throw new f(e)}else throw e.message=="Network Error"&&(this.logErrorMessage(e),window.location.href="/network_error"),this.isAxiosCancel(e)?new R(e):new f(e);throw new f(e)}isAxiosCancel(e){return e.hasOwnProperty("message")&&e.message.toLowerCase().includes("handlerequestcancellation")?(console.info("lets handle cancel event"),!0):!1}logErrorMessage(e){const t=JSON.stringify(e);i.set("network_error_log",t)}}class l extends H{constructor(t){super(t);d(this,"token","")}encodeQueryData(t){const s=[];for(const r in t)s.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return s.join("&")}async postWithCancel(t,s,r){const o={};r||(r={}),await this.addTokenToOptions(o,r);const p={...o,...r};return super.postWithCancel(t,s,p)}async post(t,s,r){const o={};r||(r={}),await this.addTokenToOptions(o,r);const p={...o,...r};return super.post(t,s,p)}async put(t,s,r){const o={};r||(r={}),await this.addTokenToOptions(o,r);const p={...o,...r};return super.put(t,s,p)}async get(t,s){const r={};s||(s={}),await this.addTokenToOptions(r,s);const o={...r,...s};return super.get(t,o)}getDefaultOptions(){return{timeout:3e4,timeoutErrorMessage:"Request timed out"}}async delete(t,s,r){const o={};s&&(o.data=s),r||(r={}),await this.addTokenToOptions(o,r);const p={...o,...r};return super.delete(t,p)}async addTokenToOptions(t,s){if(s&&s.headers&&s.headers.Authorization)return;const r=await this.getToken();if(t.hasOwnProperty("headers")||(t.headers={}),s&&s.headers){s.headers.Authorization=r;return}t.headers.Authorization=r}async getToken(){const t=k();let s=t.current_token;return s||(t.setAuthToken(),s=t.current_token),s}}const c="https://dev.auth.docbits.com",n={get_token:c+"/management/auth/get_token",dashboard:c+"/management/dashboard/",create_user:c+"/management/user/create",get_edit_delete_user:c+"/management/user/",add_to_org:c+"/management/user/add_to_org",edit_on_org:c+"/management/user/edit_on_org",remove_from_org:c+"/management/user/remove_from_org",get_delete_org:c+"/management/org/",create_org:c+"/management/org/create",create_lead:c+"/management/leads/create",get_put_delete_lead:c+"/management/leads/",convert_to_org:c+"/management/leads/customer/",edit_docbit_org:c+"/management/docbit_orgs/edit/",get_delete_docbit_org:c+"/management/docbit_orgs/",create_docbits_org:c+"/management/docbit_orgs/create",get_delete_app:c+"/management/docbit_apps/",create_app:c+"/management/docbit_apps/create",create_sub:c+"/management/docbit_subs/create",get_put_delete_sub:c+"/management/docbit_subs/",upgrade_sub:c+"/management/docbit_subs/upgrade_sub",get_delete_plan:c+"/management/docbit_plans/",create_plan:c+"/management/docbit_plans/create",edit_plan:c+"/management/docbit_plans/edit_plan",add_remove_plan_app:c+"/management/docbit_plans/add_remove_plan_app"};function M(a,e){return"Basic "+btoa(a+":"+e)}class W extends l{constructor(){super({})}async getUsers(e){const t=new FormData;return t.append("id",e),super.get(n.get_edit_delete_user+e,t)}async createUser(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_user,t)}async editUser(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.get_edit_delete_user+e.id,t)}async deleteUser(e){const t=new FormData;return t.append("id",e),super.delete(n.get_edit_delete_user+e,t)}async addToOrg(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.add_to_org,t)}async set_default(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.put(n.get_edit_delete_user+e.user_id,t)}async editOnOrg(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.put(n.edit_on_org,t)}async removeFromOrg(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.remove_from_org,t)}}class $ extends l{constructor(){super({})}handleSubscriptionError(e){throw e instanceof Error&&e.message.includes("timeout")?{message:"timeout"}:e instanceof Error&&e.message=="Network Error"?{message:"network_error"}:this.isAxiosError(e)&&e.response&&e.response.status&&e.response.status===500?{message:"network_error"}:e}async createUser(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_user,t)}async login(e,t){const s=new FormData;s.append("grant_type","password"),s.append("scope","profile");const r={headers:{Authorization:M(e,t)},timeout:1e4,error:this.handleAPILoginError.bind(this)};return super.post(n.get_token,s,r)}handleAPILoginError(e){throw e instanceof Error&&e.message.includes("timeout")?{message:"Request is taking time, Please try again after few seconds"}:e instanceof Error&&e.message=="Network Error"?{message:"network_error"}:e}}class B extends l{constructor(){super({})}async createLead(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_lead,t)}async editLead(e,t){const s=new FormData;for(const[r,o]of Object.entries(t))s.append(r,o);return super.put(n.get_put_delete_lead+e,s)}async convertToOrg(e,t){const s=new FormData;return s.append("type",t),super.post(n.convert_to_org+e,s)}async getLead(e,t=null){let s="";return t!=null&&(s="?partner_id="+t),super.get(n.get_put_delete_lead+e+s)}async deleteLead(e,t=null){const s=new FormData;s.append("id",e);let r="";return t!=null&&(r="?partner_id="+t),super.delete(n.get_put_delete_lead+e+r,s)}}class Q extends l{constructor(){super({})}async createOrg(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_org,t)}async getOrg(e){return super.get(n.get_delete_org+e)}async deleteOrg(e){const t=new FormData;return t.append("id",e),super.delete(n.get_delete_org+e,t)}}class K extends l{constructor(){super({})}async getDashboardData(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.dashboard,t)}}class N extends l{constructor(){super({})}async getApps(e){return super.get(n.get_delete_app+e)}async createApp(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_app,t)}async deleteApp(e){const t=new FormData;return t.append("id",e),super.delete(n.get_delete_app+e,t)}}class J extends l{constructor(){super({})}async getOrgs(e,t=null){let s="";return t!=null&&(s="?partner_id="+t),super.get(n.get_delete_docbit_org+e+s)}async createOrg(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_docbits_org,t)}async editOrg(e,t){const s=new FormData;return s.append("name",t.name),s.append("partner_id",t.partner_id),s.append("street",t.street),s.append("plz",t.plz),s.append("city",t.city),s.append("country",t.country),s.append("org_type",t.org_type),s.append("email",t.email),s.append("phone",t.phone),super.post(n.edit_docbit_org+e,s)}async deleteOrg(e){const t=new FormData;return t.append("id",e),super.delete(n.get_delete_docbit_org+e,t)}}class V extends l{constructor(){super({})}async getPlans(e){return super.get(n.get_delete_plan+e)}async createPlan(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_plan,t)}async deletePlan(e){const t=new FormData;return t.append("id",e),super.delete(n.get_delete_plan+e,t)}async editPlan(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.edit_plan,t)}async addAppToPlan(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.add_remove_plan_app,t)}async removeAppFromPlan(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.delete(n.add_remove_plan_app,t)}}class G extends l{constructor(){super({})}async getSubscriptions(e){return super.get(n.get_put_delete_sub+e)}async createSubscriptions(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.create_sub,t)}async upgradeSub(e){const t=new FormData;for(const[s,r]of Object.entries(e))t.append(s,r);return super.post(n.upgrade_sub,t)}async extendSub(e,t){const s=new FormData;return s.append("id",e),s.append("end",t.toUTCString()),super.put(n.get_put_delete_sub+e,s)}async deleteSub(e){const t=new FormData;return t.append("id",e),super.delete(n.get_put_delete_sub+e,t)}}const u=new W,re=new $,y=new Q,X=new K,m=new B,ne=new N,_=new J,Y=new G,b=new V,oe=h("user-store",{state:()=>({user_list:[],selected_user:{}}),getters:{getUser:a=>a.user_list},actions:{async getUsersFromServer(a){this.user_list=[];const e=await u.getUsers(a);e&&Object.keys(e).forEach(t=>{this.user_list.push(e[t])})},async getUsers(a){return await u.getUsers(a)},async deleteUser(a){if((await u.deleteUser(a.id)).success==!0){const t=this.user_list.indexOf(a);this.user_list.splice(t,1)}},async createUser(a){const e=await u.createUser(a);e.success&&this.user_list.join(e.data)},async editUser(a){const e=await u.editUser(a);if(e.success){const t=this.user_list.indexOf(e.data);this.user_list[t]=e.data}},async addToOrg(a){const e=await u.addToOrg(a);e.success&&this.selected_user.orgs.join(e.data)},async set_default(a){const e=await u.set_default(a);e.success&&(this.selected_user.orgs=e.data)},async editOnOrg(a,e){const t=await u.editOnOrg(e);if(t.success){const s=this.selected_user.orgs.indexOf(a);this.selected_user.orgs[s]=t.data}},async removeFromOrg(a){const e=await u.removeFromOrg(a);if(e.success){const t=this.selected_user.orgs.indexOf(e.data);this.selected_user.orgs.splice(t,1)}}}}),k=h("auth",{state:()=>({token:""}),getters:{getData(a){return a},current_token(a){return a.token}},actions:{setAuthToken(a){try{if(a!=null)this.token=a;else{const e=this.getTokenDetails();this.token="Bearer "+e.toString()}}catch(e){throw e}},redirectToLogin(){O.methods.logout()},setTokenInLocalStorage(a){const e=new Date,t=+a.expires_in;e.setSeconds(e.getSeconds()+t-600),a.expire_time=e,i.set("management_token",a.token),i.remove("login_attempts")},getTokenDetails(){return i.getItem("management_token")}}}),ce=h("leads",{state:()=>({leads:[]}),getters:{getLeads:a=>a.leads},actions:{async getLeadsFromServer(a,e=null){this.leads=[];const t=await m.getLead(a,e);t&&Object.keys(t).forEach(s=>{this.leads.push(t[s])})},async deleteLead(a,e=null){if((await m.deleteLead(a.id,e)).success==!0){const s=this.leads.indexOf(a);this.leads.splice(s,1)}},async createLead(a){const e=await m.createLead(a);e.success&&this.leads.push(e.data)},async editLead(a,e,t){const s=await m.editLead(a,t);s&&(this.leads[this.leads.indexOf(e)]=s,console.log(this.leads))},async convertToOrg(a,e){const t=await m.convertToOrg(a.id,e),s=this.leads.indexOf(a);this.leads[s]=t}}}),ie=h("plans",{state:()=>({plans:[]}),getters:{getPlans:a=>a.plans},actions:{async getPlansFromServer(a){this.plans=[];const e=await b.getPlans(a);e&&Object.keys(e).forEach(t=>{this.plans.push(e[t])})},async deletePlan(a){if((await b.deletePlan(a.id)).success==!0){const t=this.plans.indexOf(a);this.plans.splice(t,1)}},async createPlan(a){const e=await b.createPlan(a);e.success&&this.plans.join(e.data)}}}),de=h("mngm-org",{state:()=>({organisations:[]}),getters:{getOrgs:a=>a.organisations},actions:{async getOrgsFromServer(a){this.organisations=[];const e=await y.getOrg(a);e&&Object.keys(e).forEach(t=>{this.organisations.push(e[t])})},async deleteOrg(a){if((await y.deleteOrg(a.id)).success==!0){const t=this.organisations.indexOf(a);this.organisations.splice(t,1)}},async createOrg(a){const e=await y.createOrg(a);e.success&&this.organisations.join(e.data)}}}),pe=h("org",{state:()=>({organisations:[],selected_org:{},selected_org_subs:{},selected_org_users:{}}),getters:{getOrgs:a=>a.organisations},actions:{async getOrgsFromServer(a,e=null){this.organisations=[];const t=await _.getOrgs(a,e);t&&Object.keys(t).forEach(s=>{let r=new Date;if(Object.keys(t[s].subscriptions).length>>0){let o="expired";Object.keys(t[s].subscriptions).forEach(p=>{const w=new Date(t[s].subscriptions[p].end);w>r&&(r=w,o=w.toLocaleDateString())}),t[s].subscribed=o}else t[s].subscribed="no";this.organisations.push(t[s])})},async getSpecificOrgFromStore(a,e=null){let t=null;return this.organisations.forEach(s=>{s.org_id==a&&(t=s)}),t==null&&(t=await this.getSpecificOrg(a,e)),t},async getSpecificOrg(a,e=null){const t=await _.getOrgs(a,e);t&&(this.selected_org=t[a],this.selected_org_subs=t[a].subscriptions,this.selected_org_users=t[a].users)},async editOrg(a,e){const t=await _.editOrg(a,e);if(t.success){const s=this.organisations.indexOf(e);this.organisations[s]=t.data}},async deleteOrg(a,e){if((await _.deleteOrg(a)).success==!0){const s=this.organisations.indexOf(e);this.organisations.splice(s,1)}},async createOrg(a){const e=await _.createOrg(a);e.success&&this.organisations.join(e.data)},async createSub(a){const e=await Y.createSubscriptions(a);e&&(this.selected_org_subs[e.id]=e)}}}),ue=h("dashboard",{state:()=>({dashboardData:{}}),getters:{getData:a=>a.dashboardData},actions:{async getDashboardData(a){const e=await X.getDashboardData(a);e&&(this.dashboardData=e)}}});export{ae as Q,k as a,pe as b,ce as c,ue as d,ne as e,ie as f,oe as g,re as l,de as o,b as p,Y as s,u};
