import{t as q,h as P}from"./helperMixin.d068c683.js";import{t as R}from"./tokenUtil.2f3b530a.js";import{m as H,n as j,c as v,d as W,Q as k}from"./dashBoardStore.07acd552.js";import{Q}from"./QMarkupTable.84b614ab.js";import{aB as J,k as K,aC as X,c as h,h as p,aD as Z,g as ee,d as Y,aE as B,r as n,_ as F,m as d,n as u,p as l,f as a,s,z as i,F as D,at as G,x as C,y as S,v as te,ax as ae,ap as M,av as re,t as se}from"./index.0ecf3f3d.js";import{Q as le}from"./QSeparator.274b040b.js";import{Q as O}from"./QSelect.7a648a7a.js";import{d as N,Q as oe,a as ne,b as ie}from"./QPopupProxy.37e5ac26.js";import{b as de}from"./format.054b8074.js";import{C as z}from"./ClosePopup.9b68f329.js";import"./axios.ab682c6b.js";const ue={...J,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},$=50,L=2*$,U=L*Math.PI,ce=Math.round(U*1e3)/1e3;var me=K({name:"QCircularProgress",props:{...ue,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:r}){const{proxy:{$q:c}}=ee(),m=X(e),_=h(()=>{const o=(c.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(c.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-o}deg)`:`rotate3d(0, 0, 1, ${o-90}deg)`}}),g=h(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),t=h(()=>L/(1-e.thickness/2)),w=h(()=>`${t.value/2} ${t.value/2} ${t.value} ${t.value}`),y=h(()=>de(e.value,e.min,e.max)),I=h(()=>e.max-e.min),b=h(()=>e.thickness/2*t.value),T=h(()=>{const o=(e.max-y.value)/I.value,f=e.rounded===!0&&y.value<e.max&&o<.25?b.value/2*(1-o/.25):0;return U*o+f});function V({thickness:o,offset:f,color:x,cls:A,rounded:E}){return p("circle",{class:"q-circular-progress__"+A+(x!==void 0?` text-${x}`:""),style:g.value,fill:"transparent",stroke:"currentColor","stroke-width":o,"stroke-dasharray":ce,"stroke-dashoffset":f,"stroke-linecap":E,cx:t.value,cy:t.value,r:$})}return()=>{const o=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&o.push(p("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:$-b.value/2,cx:t.value,cy:t.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&o.push(V({cls:"track",thickness:b.value,offset:0,color:e.trackColor})),o.push(V({cls:"circle",thickness:b.value,offset:T.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const f=[p("svg",{class:"q-circular-progress__svg",style:_.value,viewBox:w.value,"aria-hidden":"true"},o)];return e.showValue===!0&&f.push(p("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},r.default!==void 0?r.default():[p("div",y.value)])),p("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:m.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:y.value},Z(r.internal,f))}}});const he=Y({el:"#app",mixins:[q,P,R],components:{},mounted(){this.init()},watch:{selected_date_range:{handler:function(e){this.selected_date_range_prev=e}},customer:{handler:function(e){this.call_data.data_org=e.value,this.newDataCall()}}},computed:{board_date:function(){return this.selected_date_range==="custom_reselect"?this.custom_date_range.from+" - "+this.custom_date_range.to:"Last "+this.selected_date_range+" days"}},methods:{async init(){this.setDate(),await this.getDashboardData({activity_start_date:this.custom_date_range.from.replace(/\//g,"-"),activity_end_date:this.custom_date_range.to.replace(/\//g,"-")}),await this.getOrgsFromServer("1"),this.organisations.forEach(e=>{this.customer_list.push({value:e.org_id,label:e.name})})},circleGraphHandler(){const e=this.dashboardData.data_analysis[0];(e.total==null||e.total==null)&&(e.total=0),this.circleGraphData.max=100,e.used>e.total?(this.circleGraphData.value=100,this.circleGraphData.color="red"):(this.circleGraphData.value=parseInt(e.used)/e.total*100,this.circleGraphData.color="primary")},async newDataCall(){this.call_data.data_start_date=this.custom_date_range.from.replace(/\//g,"-"),this.call_data.data_end_date=this.custom_date_range.to.replace(/\//g,"-"),await this.getDashboardData(this.call_data),this.circleGraphHandler()},setDate(){const e=Number(this.selected_date_range),r=new Date,c=new Date,m=r.setDate(r.getDate()-e),_=N.formatDate(m,"YYYY/MM/DD"),g=N.formatDate(c,"YYYY/MM/DD");this.custom_date_range={from:_,to:g}},dateRangeCalenderSelected(){this.custom_range_selected=!0,this.selected_date_range="custom_reselect",this.customer!=null&&this.newDataCall()},dateRangeOptionSelected(){if(this.selected_date_range==="custom"){this.selected_date_range=this.selected_date_range_prev,this.show_calender=!0;return}this.setDate()}},setup(){const e=H(),{dashboardData:r}=B(e),{getDashboardData:c}=e,m=j(),{organisations:_}=B(m),{getOrgsFromServer:g}=m;return{getDashboardData:c,dashboardData:r,getOrgsFromServer:g,organisations:_,selected_org:n(null),chartData:n([]),chart:n(null),custom_date_range:n({from:"",to:""}),show_calender:n(!1),custom_range_selected:n(!1),selected_date_range:n("30"),selected_date_range_prev:n("30"),data_range_options:[{label:"Last 7 days",value:"7"},{label:"Last 30 days",value:"30"},{label:"Select Date-Range",value:"custom"}],call_data:n({}),customer:n(null),customer_list:n([]),circleGraphData:n({value:0,max:100,color:"primary"})}}}),_e={class:"row",style:{"margin-top":"20px"}},ge={class:"col-4"},fe={style:{"margin-left":"20px"}},ve={style:{"margin-left":"20px"}},pe={class:"text-right"},ye={class:"col-4"},be={style:{"margin-left":"20px"}},De={class:"row items-center justify-end q-gutter-sm"},we={class:"text-center",style:{"margin-top":"20px"}},ke=l("div",{class:"col-4"},null,-1);function Ce(e,r,c,m,_,g){return d(),u("div",_e,[l("div",ge,[a(k,{style:{"margin-left":"2.5%",width:"95%",height:"52%"}},{default:s(()=>[a(v,null,{default:s(()=>[l("div",fe,i(e.$t("new_clients")),1)]),_:1}),a(v,null,{default:s(()=>[a(Q,{flat:""},{default:s(()=>[l("tbody",null,[(d(!0),u(D,null,G(e.dashboardData.new_clients,t=>(d(),u("tr",{key:t},[l("td",null,i(t.name),1),l("td",null,i(new Date(t.created_on).toLocaleDateString()),1)]))),128))])]),_:1})]),_:1}),a(W,null,{default:s(()=>[a(C,{align:"right",style:{width:"auto","margin-top":"-12px"},label:e.$t("show_more"),color:"primary",onClick:r[0]||(r[0]=t=>e.$router.push("/docbits"))},null,8,["label"])]),_:1})]),_:1}),a(le,{style:{"margin-top":"10px","margin-bottom":"10px","margin-left":"2.5%",width:"95%"}}),a(k,{style:{"margin-left":"2.5%",width:"95%",height:"45%"}},{default:s(()=>[a(v,null,{default:s(()=>[l("div",ve,i(e.$t("top_customers")),1)]),_:1}),a(v,null,{default:s(()=>[a(Q,{flat:""},{default:s(()=>[l("tbody",null,[(d(!0),u(D,null,G(e.dashboardData.top_clients,(t,w)=>(d(),u("tr",{key:t},[l("td",null,i(w+1),1),l("td",null,i(t.name),1),l("td",pe,i(t.hits),1)]))),128))])]),_:1})]),_:1})]),_:1})]),l("div",ye,[a(k,{style:{"margin-left":"2.5%",width:"95%"}},{default:s(()=>[a(v,null,{default:s(()=>[l("div",be,i(e.$t("data_analysis")),1)]),_:1}),a(v,null,{default:s(()=>[a(O,{style:{"margin-left":"15%",width:"70%","margin-top":"-15px"},dense:"",outlined:"",label:e.$t("customer"),modelValue:e.customer,"onUpdate:modelValue":r[1]||(r[1]=t=>e.customer=t),options:e.customer_list},null,8,["label","modelValue","options"]),a(O,{outlined:"",dense:"",modelValue:e.selected_date_range,"onUpdate:modelValue":[r[5]||(r[5]=t=>e.selected_date_range=t),e.dateRangeOptionSelected],options:e.data_range_options,class:"white-inputs",label:e.$t("time_unit"),style:{"margin-left":"15%",width:"70%"},"emit-value":"","map-options":""},{selected:s(()=>[e.selected_date_range==="custom"?(d(),u(D,{key:0},[S(i(e.board_date),1)],64)):(d(),u(D,{key:1},[S(i(e.board_date),1)],64))]),append:s(()=>[a(te,{name:"event",class:"cursor-pointer",onClick:r[4]||(r[4]=ae(()=>{},["stop","prevent"]))},{default:s(()=>[a(oe,null,{default:s(()=>[S("Select Date-Range")]),_:1}),a(ne,{cover:"",modelValue:e.show_calender,"onUpdate:modelValue":r[3]||(r[3]=t=>e.show_calender=t),"transition-show":"scale","transition-hide":"scale",ref:"qDateProxy"},{default:s(()=>[a(ie,{modelValue:e.custom_date_range,"onUpdate:modelValue":r[2]||(r[2]=t=>e.custom_date_range=t),minimal:"",range:""},{default:s(()=>[l("div",De,[M(a(C,{label:e.$t("close"),color:"red"},null,8,["label"]),[[z]]),M(a(C,{label:"Ok",color:"primary",onClick:e.dateRangeCalenderSelected},null,8,["onClick"]),[[z]])])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","label"]),l("div",we,[a(me,{min:0,value:e.circleGraphData.value,max:e.circleGraphData.max,"show-value":"",color:e.circleGraphData.color,"track-color":"grey-3","font-size":"30px",size:"200px"},null,8,["value","max","color"])])]),_:1})]),_:1})]),ke])}var Se=F(he,[["render",Ce]]);const $e=Y({el:"#app",mixins:[q,P,R],components:{admin_table:Se},mounted(){const e=this.getCurrentOrgInLocalStorage();e!=null&&(this.type=e.type)},methods:{},setup(){return{type:n("")}}}),Ve={key:0},xe={key:1};function Qe(e,r,c,m,_,g){const t=re("admin_table");return e.type=="management"?(d(),u("div",Ve,[a(t)])):e.type=="partner"?(d(),u("div",xe)):se("",!0)}var Le=F($e,[["render",Qe]]);export{Le as default};
