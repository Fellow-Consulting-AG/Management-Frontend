import{_ as R,d as I,aE as D,r as n,m as r,n as c,p as o,f as s,v as E,z as i,x as d,s as a,u as m,F as T,at as B,aw as w,y as F,ap as k,A as M,B as N,ax as q,q as _,t as g}from"./index.5a13da41.js";import{Q as p}from"./QSeparator.d62debe8.js";import{Q as b}from"./QInput.fd9ec3a6.js";import{y as z,n as A,Q as $,b as U,c as u,d as V}from"./dashBoardStore.febfba2d.js";import{Q as K,a as h,b as v,C}from"./ClosePopup.64cf678d.js";import{Q as P}from"./QList.d4c99368.js";import{Q as j}from"./QMarkupTable.0edf7ced.js";import{Q as L}from"./QSelect.00f518eb.js";import{t as G,h as H}from"./helperMixin.9f6d5065.js";import{t as J}from"./tokenUtil.9ae76fd1.js";import"./axios.ab682c6b.js";import"./format.054b8074.js";const W=I({el:"#app",mixins:[G,H,J],beforeMount(){this.init()},methods:{async init(){this.user_id=this.$route.params.id,this.selected_user=await this.useDocbitUserStore.getUsers(this.user_id),await this.getOrgsFromServer("1"),this.organisations.forEach(e=>{this.customer_list.push({value:e.org_id,label:e.name})})},async deleteUser(){await this.useDocbitUserStore.deleteUser(this.selected_user),this.$router.push("/users")},async addOrg(){if(!this.org){this.showErrorToast(this.$t("error_message.ORG_NOT_SET"));return}const e={user_id:this.selected_user.id,org_id:this.add_org.value};await this.useDocbitUserStore.addToOrg(e),this.addToOrg=!1},async set_org_admin(e,t){const f={user_id:this.selected_user.id,org_id:e.org_id,is_org_admin:t};await this.useDocbitUserStore.editOnOrg(e,f)},async set_default(e){const t={user_id:this.selected_user.id,org_id:e.org_id};console.log(e.org_id),await this.useDocbitUserStore.set_default(t)},async removeOrg(){const e={user_id:this.selected_user.id,org_id:this.org.org_id};await this.useDocbitUserStore.removeFromOrg(e),this.confirmRemove=!1},async checkUpdate(){this.editing==!1&&(await this.useDocbitUserStore.editUser(this.selected_user),this.showSuccessToast(this.$t("success_message.UPDATED_USER")))},hasOrgs(){return this.selected_user.orgs.length>0}},setup(){const e=z(),{selected_user:t}=D(e),f=A(),{organisations:S}=D(f),{getOrgsFromServer:Q}=f;return{selected_user:t,organisations:S,getOrgsFromServer:Q,useDocbitUserStore:e,add_org:n(),user_id:n(""),org:n({}),customer_list:n([]),editing:n(!1),addToOrg:n(!1),deleteuser:n(!1),confirmRemove:n(!1),confirmDelete:n(!1)}}}),O=e=>(M("data-v-7151691e"),e=e(),N(),e),X={style:{"margin-left":"15%","max-width":"70%"}},Y={class:"row",style:{height:"100px"}},Z={class:"col-7 text-weight-bold text-primary",style:{"margin-top":"30px","font-size":"30px"}},x={class:"col-2 row"},ee=O(()=>o("div",{class:"col-1"},null,-1)),se=O(()=>o("div",{class:"col-1"},null,-1)),te={style:{"margin-left":"10px"},class:"row"},le={class:"col-1"},oe={class:"input-name-top"},ae={class:"input-name-normal"},ie={class:"col-4"},re={class:"col-1"},de={class:"input-name-top"},ne={class:"input-name-normal"},ue={class:"col-4"},me={class:"col-4"},pe={color:"primary",style:{"font-size":"x-large"}},fe=O(()=>o("div",{class:"col-5"},null,-1)),ce={class:"col-3",style:{"min-width":"100px"}},_e={class:"text-left"},ge={class:"text-right"},he={class:"text-left"},ve={class:"text-center"},ye={class:"text-center"},be={class:"text-right"},$e={class:"text-green-14"},we={class:"text-green-14"},ke={class:"text-green-14"},Ue={class:"text-blue-14"},Ve={class:"text-red-14"},Ce={key:0,class:"q-ml-sm"},Oe={key:1,class:"q-ml-sm"},Se={class:"q-ml-sm"};function Qe(e,t,f,S,Q,De){return r(),c(T,null,[o("div",X,[o("div",Y,[s(E,{class:"col-2",name:"user"}),o("div",Z,i(e.selected_user.first_name)+" "+i(e.selected_user.last_name),1),o("div",x,[ee,s(d,{class:"col-5",style:{height:"30px","max-width":"45%","margin-top":"30px"},color:"primary",label:e.editing===!0?e.$t("stop_editing"):e.$t("edit"),onClick:t[0]||(t[0]=l=>(e.editing=!e.editing,e.checkUpdate()))},null,8,["label"]),se,s(d,{class:"col-5",style:{height:"30px","max-width":"45%","margin-top":"30px"},color:"red",label:e.$t("delete"),onClick:t[1]||(t[1]=l=>e.confirmDelete=!0)},null,8,["label"])])]),s(p,{class:"separators"}),o("div",te,[o("div",le,[o("div",oe,i(e.$t("first_name")),1),o("div",ae,i(e.$t("email")),1)]),o("div",ie,[s(b,{class:"input-field",dense:"",borderless:!e.editing,disable:!e.editing,modelValue:e.selected_user.first_name,"onUpdate:modelValue":t[2]||(t[2]=l=>e.selected_user.first_name=l)},null,8,["borderless","disable","modelValue"]),s(b,{class:"input-field",dense:"",borderless:!e.editing,disable:!e.editing,modelValue:e.selected_user.email,"onUpdate:modelValue":t[3]||(t[3]=l=>e.selected_user.email=l)},null,8,["borderless","disable","modelValue"])]),o("div",re,[o("div",de,i(e.$t("last_name")),1),o("div",ne,i(e.$t("created_on")),1)]),o("div",ue,[s(b,{class:"input-field",dense:"",borderless:!e.editing,disable:!e.editing,modelValue:e.selected_user.last_name,"onUpdate:modelValue":t[4]||(t[4]=l=>e.selected_user.last_name=l)},null,8,["borderless","disable","modelValue"]),s(b,{class:"input-field",dense:"",borderless:!e.editing,disable:!0,modelValue:e.selected_user.created_on,"onUpdate:modelValue":t[5]||(t[5]=l=>e.selected_user.created_on=l)},null,8,["borderless","modelValue"])])]),s(p,{class:"separators",style:{"margin-top":"20px"}}),s($,{class:"organisation-card"},{default:a(()=>[s(u,{class:"row"},{default:a(()=>[o("div",me,[o("span",pe,i(e.$t("organisations")),1)]),fe,o("div",ce,[s(d,{style:{height:"30px","min-width":"170px"},color:"primary",label:e.$t("add_to_org"),onClick:t[6]||(t[6]=l=>e.addToOrg=!0)},null,8,["label"])])]),_:1}),s(u,null,{default:a(()=>[s(j,{flat:""},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",_e,i(e.$t("name")),1),o("th",null,i(e.$t("is_org_admin")),1),o("th",null,i(e.$t("is_default")),1),o("th",ge,i(e.$t("actions")),1)])]),o("tbody",null,[(r(!0),c(T,null,B(e.selected_user.orgs,l=>(r(),c("tr",{key:l},[o("td",he,i(l.org_name),1),o("td",ve,i(l.is_org_admin),1),o("td",ye,i(l.is_default),1),o("td",be,[s(d,{flat:"",dense:"",round:"",onClick:t[7]||(t[7]=q(()=>{},["stop","prevent"])),icon:"more_horiz"},{default:a(()=>[s(K,null,{default:a(()=>[s(P,{dense:"",style:{"min-width":"100px"}},{default:a(()=>[l.is_default==!1?(r(),_(h,{key:0,clickable:""},{default:a(()=>[s(v,{onClick:y=>e.set_default(l)},{default:a(()=>[o("span",$e,i(e.$t("set_default")),1)]),_:2},1032,["onClick"])]),_:2},1024)):g("",!0),l.is_org_admin==!1?(r(),_(p,{key:1})):g("",!0),l.is_org_admin==!1?(r(),_(h,{key:2,clickable:""},{default:a(()=>[s(v,{onClick:y=>e.set_org_admin(l,!0)},{default:a(()=>[o("span",we,i(e.$t("set_org_admin")),1)]),_:2},1032,["onClick"])]),_:2},1024)):g("",!0),l.is_org_admin==!0?(r(),_(p,{key:3})):g("",!0),l.is_org_admin==!0?(r(),_(h,{key:4,clickable:""},{default:a(()=>[s(v,{onClick:y=>e.set_org_admin(l,!1)},{default:a(()=>[o("span",ke,i(e.$t("set_org_user")),1)]),_:2},1032,["onClick"])]),_:2},1024)):g("",!0),s(p),s(h,{clickable:""},{default:a(()=>[s(v,{onClick:y=>this.$router.push("/client/"+l.org_id)},{default:a(()=>[o("span",Ue,i(e.$t("open_org")),1)]),_:2},1032,["onClick"])]),_:2},1024),s(p),s(h,{clickable:""},{default:a(()=>[s(v,{onClick:y=>{this.org=l,e.confirmRemove=!0}},{default:a(()=>[o("span",Ve,i(e.$t("remove_user_from_org")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1})]),_:1})]),_:1})]),s(U,{modelValue:e.addToOrg,"onUpdate:modelValue":t[10]||(t[10]=l=>e.addToOrg=l),persistent:"",onKeypress:[t[11]||(t[11]=m(l=>e.addToOrg=!1,["esc"])),t[12]||(t[12]=m(l=>e.addOrg(),["enter"]))]},{default:a(()=>[s($,null,{default:a(()=>[s(u,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:a(()=>[s(w,{icon:"info",color:"primary","text-color":"white"}),F(" "+i(e.$t("add_to_org")),1)]),_:1}),s(u,{class:"row items-center"},{default:a(()=>[s(L,{style:{width:"300px"},modelValue:e.add_org,"onUpdate:modelValue":t[8]||(t[8]=l=>e.add_org=l),options:e.customer_list},null,8,["modelValue","options"])]),_:1}),s(V,null,{default:a(()=>[k(s(d,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[C]]),s(d,{align:"right",flat:"",label:e.$t("proceed"),color:"primary",onClick:t[9]||(t[9]=l=>e.addOrg())},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(U,{modelValue:e.confirmDelete,"onUpdate:modelValue":t[14]||(t[14]=l=>e.confirmDelete=l),persistent:"",onKeypress:[t[15]||(t[15]=m(l=>e.confirmDelete=!1,["esc"])),t[16]||(t[16]=m(l=>e.deleteUser(),["enter"]))]},{default:a(()=>[s($,null,{default:a(()=>[s(u,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:a(()=>[s(w,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),s(u,{class:"row items-center"},{default:a(()=>[e.hasOrgs()?(r(),c("span",Ce,i(e.$t("popups.msg_user_in_orgs")),1)):(r(),c("span",Oe,i(e.$t("popups.msg_delete")),1))]),_:1}),s(V,{style:{"margin-left":"35%"}},{default:a(()=>[k(s(d,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[C]]),s(d,{align:"right",flat:"",label:e.$t("proceed"),color:"primary",onClick:t[13]||(t[13]=l=>e.deleteUser()),disable:e.hasOrgs()},null,8,["label","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(U,{modelValue:e.confirmRemove,"onUpdate:modelValue":t[18]||(t[18]=l=>e.confirmRemove=l),persistent:"",onKeypress:[t[19]||(t[19]=m(l=>e.confirmRemove=!1,["esc"])),t[20]||(t[20]=m(l=>e.removeOrg(),["enter"]))]},{default:a(()=>[s($,null,{default:a(()=>[s(u,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:a(()=>[s(w,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),s(u,{class:"row items-center"},{default:a(()=>[o("span",Se,i(e.$t("popups.msg_user_remove")),1)]),_:1}),s(V,null,{default:a(()=>[k(s(d,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[C]]),s(d,{align:"right",flat:"",label:e.$t("proceed"),color:"primary",onClick:t[17]||(t[17]=l=>e.removeOrg())},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Pe=R(W,[["render",Qe],["__scopeId","data-v-7151691e"]]);export{Pe as default};
