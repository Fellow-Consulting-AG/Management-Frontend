import{t as w,h as g}from"./helperMixin.49b9bb7b.js";import{d as P,r,_ as C,m as u,n as m,q as A,s,f as t,y as D,z as n,p as a,x as i,F as v,at as I,t as U,ap as c,aw as F,ax as q,aE as G,av as M,u as j,A as H,B as J}from"./index.97fa15ac.js";import{Q as _}from"./QSeparator.08273e50.js";import{Q as N,a as z,b as E,C as f}from"./ClosePopup.7589ed8c.js";import{Q as K}from"./QList.8eb34949.js";import{Q as O}from"./QMarkupTable.44744e66.js";import{r as B,s as W,c as p,Q as h,d as y,b as $,t as L}from"./dashBoardStore.bb2d31f2.js";import{Q as X}from"./QSelect.f2f89d81.js";import{Q as b}from"./QInput.fc2ed771.js";import"./axios.ab682c6b.js";import"./format.054b8074.js";const Y=P({el:"#app",mixins:[w,g],props:{plan_data:{type:Object,default:{}}},mounted(){this.apps=this.plan_data.apps},methods:{async removeAppFromPlan(){const e={plan_id:this.plan_data.id,app_id:this.add_app.value};(await B.removeAppFromPlan(e)).success&&delete this.apps[this.add_app.value]},async getApps(){this.applist=[],(await W.getApps("all")).data.forEach(l=>{l.value=l.id,l.label=l.name,this.applist.push(l)})},async addAppToPlan(){const e={plan_id:this.plan_data.id,app_id:this.add_app.value,credit:this.credits},l=await B.addAppToPlan(e);l.success&&(this.apps[this.add_app.value]=l)}},setup(){return{current_mode:r("list"),apps:r([{}]),app_id:r(""),current_app:r({}),applist:r([{}]),credits:r(0),add_app:r(),confirmDelete:r(!1)}}}),Z={class:"text-right"},x={class:"text-left table-header"},ee={class:"text-center table-header"},te={class:"text-center table-header"},le={class:"text-right table-header"},ae={class:"text-left"},se={class:"text-center"},oe={class:"text-center"},ne={class:"text-right"},de={class:"text-red-14"},re={class:"row"},ie=a("div",{class:"col-1"},null,-1),pe={class:"col-7"},ue={class:"col-2",style:{"margin-left":"10px"}},me=a("div",{class:"col-1"},null,-1),ce={class:"q-ml-sm"};function fe(e,l,V,k,Q,S){return u(),m(v,null,[e.current_mode=="list"?(u(),A(h,{key:0,style:{"max-width":"1400px",width:"700px"}},{default:s(()=>[t(p,null,{default:s(()=>[D(n(e.plan_data.name)+" ",1),a("div",Z,[t(i,{style:{"margin-top":"-40px","margin-bottom":"10px"},dense:"",color:"primary",label:e.$t("popups.add_app"),onClick:l[0]||(l[0]=o=>(e.current_mode="add",this.getApps()))},null,8,["label"])])]),_:1}),t(_,{style:{"margin-top":"-25px"}}),t(p,null,{default:s(()=>[t(O,null,{default:s(()=>[a("thead",null,[a("tr",null,[a("th",x,n(e.$t("name")),1),a("th",ee,n(e.$t("key")),1),a("th",te,n(e.$t("credit")),1),a("th",le,n(e.$t("actions")),1)])]),a("tbody",null,[(u(!0),m(v,null,I(e.apps,o=>(u(),m("tr",{key:o},[a("td",ae,n(o.name),1),a("td",se,n(o.key),1),a("td",oe,n(o.credit),1),a("td",ne,[t(i,{flat:"",dense:"",round:"",onClick:l[1]||(l[1]=q(()=>{},["stop","prevent"])),icon:"more_horiz"},{default:s(()=>[t(N,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:s(()=>[t(K,{dense:"",style:{"min-width":"100px"}},{default:s(()=>[t(z,{clickable:""},{default:s(()=>[t(E,{onClick:T=>{e.current_app=o,e.confirmDelete=!0}},{default:s(()=>[a("span",de,n(e.$t("remove")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1})]),_:1})]),_:1})):U("",!0),e.current_mode=="add"?(u(),A(h,{key:1,style:{width:"700px",height:"200px"}},{default:s(()=>[t(p,null,{default:s(()=>[D(n(e.$t("popups.add_app_to_plan")),1)]),_:1}),t(_),t(p,null,{default:s(()=>[a("div",re,[ie,a("div",pe,[t(X,{modelValue:e.add_app,"onUpdate:modelValue":l[2]||(l[2]=o=>e.add_app=o),label:e.$t("name"),options:e.applist},null,8,["modelValue","label","options"])]),a("div",ue,[t(b,{modelValue:e.credits,"onUpdate:modelValue":l[3]||(l[3]=o=>e.credits=o),label:e.$t("credits"),type:"number"},null,8,["modelValue","label"])]),me])]),_:1}),t(_),t(y,{style:{"margin-left":"35%"}},{default:s(()=>[t(i,{label:e.$t("cancel"),onClick:l[4]||(l[4]=o=>e.current_mode="list")},null,8,["label"]),c(t(i,{color:"primary",label:e.$t("add"),onClick:l[5]||(l[5]=o=>e.addAppToPlan())},null,8,["label"]),[[f,-1]])]),_:1})]),_:1})):U("",!0),t($,{modelValue:e.confirmDelete,"onUpdate:modelValue":l[7]||(l[7]=o=>e.confirmDelete=o),persistent:""},{default:s(()=>[t(h,null,{default:s(()=>[t(p,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:s(()=>[t(F,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),t(p,{class:"row items-center"},{default:s(()=>[a("span",ce,n(e.$t("msg.remove")),1)]),_:1}),t(y,{align:"right"},{default:s(()=>[c(t(i,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[f]]),c(t(i,{flat:"",label:e.$t("done"),color:"primary",onClick:l[6]||(l[6]=o=>e.removeAppFromPlan())},null,8,["label"]),[[f]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var _e=C(Y,[["render",fe]]);const he=P({el:"#app",mixins:[w,g],methods:{async createPlan(){await this.usedocbitPlanStore.createPlan(this.plan)}},setup(){return{usedocbitPlanStore:L(),plan:r({})}}}),$e={class:"row"},be=a("div",{class:"col-1"},null,-1),ve={class:"col-10"},ye=a("div",{class:"col-1"},null,-1),we={class:"row"},ge=a("div",{class:"col-1"},null,-1),Pe={class:"col-4"},Ce=a("div",{class:"col-2"},null,-1),Ve={class:"col-4"},ke=a("div",{class:"col-1"},null,-1);function Qe(e,l,V,k,Q,S){return u(),A(h,{style:{width:"700px",height:"260px"}},{default:s(()=>[t(p,null,{default:s(()=>[D(n(e.$t("popups.create_plan")),1)]),_:1}),t(_),t(p,null,{default:s(()=>[a("div",$e,[be,a("div",ve,[t(b,{modelValue:e.plan.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.plan.name=o),label:e.$t("name")},null,8,["modelValue","label"])]),ye]),a("div",we,[ge,a("div",Pe,[t(b,{mask:"#####",modelValue:e.plan.days,"onUpdate:modelValue":l[1]||(l[1]=o=>e.plan.days=o),label:e.$t("days")},null,8,["modelValue","label"])]),Ce,a("div",Ve,[t(b,{mask:"#######",modelValue:e.plan.price,"onUpdate:modelValue":l[2]||(l[2]=o=>e.plan.price=o),label:e.$t("price")},null,8,["modelValue","label"])]),ke])]),_:1}),t(_),t(y,{style:{"margin-left":"35%"}},{default:s(()=>[c(t(i,{label:e.$t("cancel")},null,8,["label"]),[[f,-1]]),c(t(i,{color:"primary",label:e.$t("create"),onClick:l[3]||(l[3]=o=>e.createPlan())},null,8,["label"]),[[f,-1]])]),_:1})]),_:1})}var Se=C(he,[["render",Qe]]);const Ae=P({el:"#app",mixins:[w,g],components:{AppPopup:_e,CreatePlan:Se},mounted(){this.getOrgData()},methods:{async getOrgData(){await this.usePlanStore.getPlansFromServer("all")},openPlanMenu(e){this.currentPlan=e,this.show_app_menu=!0},async deletePlan(){await this.usePlanStore.deletePlan(this.selected_plan)}},setup(){const e=L(),{plans:l}=G(e);return{usePlanStore:e,plans:l,plan_id:r(""),selected_plan:r({}),openCreateMenu:r(!1),currentPlan:r({}),confirmDelete:r(!1),show_app_menu:r(!1)}}}),De=e=>(H("data-v-3f28b186"),e=e(),J(),e),Me={class:"",style:{margin:"20px"}},Te={class:"row",style:{"margin-bottom":"10px"}},Ue=De(()=>a("div",{class:"col-11"},null,-1)),je={class:"text-left table-header"},Be={class:"text-center table-header"},Ie={class:"text-center table-header"},Fe={class:"text-center table-header"},qe={class:"text-right table-header"},Ne=["onClick"],ze={class:"text-left"},Ee={class:"text-center"},Ke={class:"text-center"},Oe={class:"text-center"},Le={class:"text-right"},Re={class:"text-red-14"},Ge={class:"q-ml-sm"};function He(e,l,V,k,Q,S){const o=M("AppPopup"),T=M("CreatePlan");return u(),m(v,null,[a("div",Me,[a("div",Te,[Ue,t(i,{class:"col-1",color:"primary",label:e.$t("create"),onClick:l[0]||(l[0]=d=>e.openCreateMenu=!0)},null,8,["label"])]),t(O,{flat:"",class:"sticky-column-for-table q-table-seperator",style:{"max-height":"80vh",overflow:"auto"},dense:""},{default:s(()=>[a("thead",null,[a("tr",null,[a("th",je,n(e.$t("name")),1),a("th",Be,n(e.$t("days")),1),a("th",Ie,n(e.$t("price")),1),a("th",Fe,n(e.$t("credits")),1),a("th",qe,n(e.$t("actions")),1)])]),a("tbody",null,[(u(!0),m(v,null,I(e.plans,d=>(u(),m("tr",{key:d,onClick:R=>e.openPlanMenu(d)},[a("td",ze,n(d.name),1),a("td",Ee,n(d.days),1),a("td",Ke,n(d.price),1),a("td",Oe,n(d.credits),1),a("td",Le,[t(i,{flat:"",dense:"",round:"",onClick:l[1]||(l[1]=q(()=>{},["stop","prevent"])),icon:"more_horiz"},{default:s(()=>[t(N,{persistent:"","auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:s(()=>[t(K,{dense:"",style:{"min-width":"100px"}},{default:s(()=>[t(_,{inset:""}),t(z,{clickable:""},{default:s(()=>[t(E,{onClick:R=>{e.selected_plan=d,e.confirmDelete=!0}},{default:s(()=>[a("span",Re,n(e.$t("delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,Ne))),128))])]),_:1})]),t($,{modelValue:e.show_app_menu,"onUpdate:modelValue":l[2]||(l[2]=d=>e.show_app_menu=d),onKeydown:l[3]||(l[3]=j(d=>e.show_app_menu=!1,["esc"]))},{default:s(()=>[t(o,{plan_data:e.currentPlan},null,8,["plan_data"])]),_:1},8,["modelValue"]),t($,{modelValue:e.openCreateMenu,"onUpdate:modelValue":l[4]||(l[4]=d=>e.openCreateMenu=d),onKeydown:l[5]||(l[5]=j(d=>e.openCreateMenu=!1,["esc"])),persistent:""},{default:s(()=>[t(T,{plan:e.plan},null,8,["plan"])]),_:1},8,["modelValue"]),t($,{modelValue:e.confirmDelete,"onUpdate:modelValue":l[7]||(l[7]=d=>e.confirmDelete=d),persistent:""},{default:s(()=>[t(h,null,{default:s(()=>[t(p,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:s(()=>[t(F,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),t(p,{class:"row items-center"},{default:s(()=>[a("span",Ge,n(e.$t("popups.msg_delete")),1)]),_:1}),t(y,{align:"right"},{default:s(()=>[c(t(i,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[f]]),c(t(i,{flat:"",label:e.$t("done"),color:"primary",onClick:l[6]||(l[6]=d=>e.deletePlan())},null,8,["label"]),[[f]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Je=C(Ae,[["render",He],["__scopeId","data-v-3f28b186"]]);const We=P({el:"#app",mixins:[w,g],components:{PlanTable:Je},methods:{},setup(){return{}}});function Xe(e,l,V,k,Q,S){const o=M("PlanTable");return u(),m("div",null,[t(o)])}var rt=C(We,[["render",Xe]]);export{rt as default};
