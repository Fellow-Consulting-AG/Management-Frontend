import{t as V,h as k}from"./helperMixin.d068c683.js";import{t as z}from"./tokenUtil.2f3b530a.js";import{Q as p}from"./QInput.9f84b131.js";import{d as w,r as a,_ as B,m as b,q as A,s as i,f as l,y as c,z as r,p as s,ap as v,x as f,t as j,aE as q,av as O,n as h,au as d,F as D,at as E,u as I,aw as R,ax as G,A as N,B as K}from"./index.0ecf3f3d.js";import{Q as y}from"./QSeparator.274b040b.js";import{C,Q as H,a as F,b as P}from"./ClosePopup.9b68f329.js";import{Q as J}from"./QList.0469fa79.js";import{Q as Y}from"./QMarkupTable.84b614ab.js";import{n as Q,c as _,d as U,Q as L,v as W,b as T}from"./dashBoardStore.07acd552.js";import{Q as X}from"./QCheckbox.97917492.js";import"./axios.ab682c6b.js";const Z=w({el:"#app",mixins:[V,k],methods:{async createOrg(){await this.docstore.createOrg(this.org)}},setup(){return{docstore:Q(),org:a({}),create_org:a(!0)}}}),x={class:"row"},ee=s("div",{class:"col-1"},null,-1),te={class:"col-10"},se=s("div",{class:"col-1"},null,-1),oe={class:"row"},le=s("div",{class:"col-1"},null,-1),ne={class:"col-4"},re=s("div",{class:"col-2"},null,-1),ae={class:"col-4"},ie=s("div",{class:"col-1"},null,-1),de={class:"row"},ue=s("div",{class:"col-1"},null,-1),ce={class:"col-4"},pe=s("div",{class:"col-2"},null,-1),me={class:"col-4"},be=s("div",{class:"col-1"},null,-1);function ge(e,t,m,g,$,u){return e.create_org==!0?(b(),A(L,{key:0,style:{width:"700px",height:"330px"}},{default:i(()=>[l(_,null,{default:i(()=>[c(r(e.$t("popups.create_org")),1)]),_:1}),l(y),l(_,null,{default:i(()=>[s("div",x,[ee,s("div",te,[l(p,{modelValue:e.org.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.org.name=o),label:e.$t("name")},null,8,["modelValue","label"])]),se]),s("div",oe,[le,s("div",ne,[l(p,{modelValue:e.org.street,"onUpdate:modelValue":t[1]||(t[1]=o=>e.org.street=o),label:e.$t("street")},null,8,["modelValue","label"])]),re,s("div",ae,[l(p,{modelValue:e.org.plz,"onUpdate:modelValue":t[2]||(t[2]=o=>e.org.plz=o),label:e.$t("plz")},null,8,["modelValue","label"])]),ie]),s("div",de,[ue,s("div",ce,[l(p,{modelValue:e.org.city,"onUpdate:modelValue":t[3]||(t[3]=o=>e.org.city=o),label:e.$t("city")},null,8,["modelValue","label"])]),pe,s("div",me,[l(p,{modelValue:e.org.country,"onUpdate:modelValue":t[4]||(t[4]=o=>e.org.country=o),label:e.$t("country")},null,8,["modelValue","label"])]),be])]),_:1}),l(y),l(U,{style:{"margin-left":"35%"}},{default:i(()=>[v(l(f,{label:e.$t("cancel")},null,8,["label"]),[[C,-1]]),v(l(f,{color:"primary",label:e.$t("create"),onClick:t[5]||(t[5]=o=>e.createOrg())},null,8,["label"]),[[C,-1]])]),_:1})]),_:1})):j("",!0)}var $e=B(Z,[["render",ge]]);const fe=w({el:"#app",mixins:[V,k],props:{organisation:{type:Object,default:{}}},mounted(){this.user.is_admin=!1,this.user.org_id=this.organisation.org_id},methods:{async createOrg(){await this.userApiService.createUser(this.user)}},setup(){return{userApiService:W,is_admin:a(!1),user:a({})}}}),he={class:"row"},ve=s("div",{class:"col-1"},null,-1),Ce={class:"col-4"},_e=s("div",{class:"col-1"},null,-1),ye={class:"col-4"},Ve=s("div",{class:"col-1"},null,-1),ke={class:"row"},we=s("div",{class:"col-1"},null,-1),Be={class:"col-4"},Se=s("div",{class:"col-1"},null,-1),Oe={class:"col-4"},Te={class:"col-1"};function De(e,t,m,g,$,u){return b(),A(L,{style:{width:"700px",height:"260px"}},{default:i(()=>[l(_,null,{default:i(()=>[c(r(e.$t("popups.create_user")),1)]),_:1}),l(y),l(_,null,{default:i(()=>[s("div",he,[ve,s("div",Ce,[l(p,{modelValue:e.user.first_name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.user.first_name=o),label:e.$t("first_name")},null,8,["modelValue","label"])]),_e,s("div",ye,[l(p,{modelValue:e.user.last_name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.user.last_name=o),label:e.$t("last_name")},null,8,["modelValue","label"])]),Ve]),s("div",ke,[we,s("div",Be,[l(p,{modelValue:e.user.email,"onUpdate:modelValue":t[2]||(t[2]=o=>e.user.email=o),label:e.$t("email")},null,8,["modelValue","label"])]),Se,s("div",Oe,[l(p,{type:"password",modelValue:e.user.password,"onUpdate:modelValue":t[3]||(t[3]=o=>e.user.password=o),label:e.$t("password")},null,8,["modelValue","label"])]),s("div",Te,[l(X,{style:{"margin-top":"20px","margin-left":"15px"},modelValue:e.user.is_admin,"onUpdate:modelValue":t[4]||(t[4]=o=>e.user.is_admin=o),dense:"",flat:"","toggle-indeterminate":!1,label:e.user.is_admin?e.$t("admin"):e.$t("user")},null,8,["modelValue","label"])])])]),_:1}),l(y),l(U,{style:{"margin-left":"35%"}},{default:i(()=>[v(l(f,{label:e.$t("cancel")},null,8,["label"]),[[C,-1]]),v(l(f,{color:"primary",label:e.$t("create"),onClick:t[5]||(t[5]=o=>e.createOrg())},null,8,["label"]),[[C,-1]])]),_:1})]),_:1})}var Qe=B(fe,[["render",De]]);const Ue=w({el:"#app",mixins:[V,k],components:{CreateUserPop:Qe,CreateOrgPop:$e},watch:{organisations:{handler:function(e){this.orgs=e}}},mounted(){this.getOrgData()},methods:{async getOrgData(){await this.useDocbitOrgStore.getOrgsFromServer("1")},openOrgMenu(e){this.$router.push("/client/"+e.org_id)},async deleteOrg(){await this.useDocbitOrgStore.deleteOrg(this.selected_org.org_id,this.selected_org)},applyFilter(){this.orgs=[],this.organisations.forEach(e=>{e:for(const t in e){if(e[t]==null)continue;if(e[t].toString().toLowerCase().includes(this.search_filter.toLowerCase())){this.orgs.push(e);break e}}})},sortTable(e,t){this.sortColumn=e,this.sortOrder=t,this.sortedColumns()},getSortButtonClass(e,t){return{"active-sort-button":this.sortColumn===e&&this.sortOrder===t,"sort-button":!0}},sortedColumns(){const e=this.orgs,t=this.sortColumn,m=this.sortOrder;t&&e.sort((g,$)=>{let u=g[t],o=$[t];return typeof u=="string"&&(u=u.toLowerCase()),typeof o=="string"&&(o=o.toLowerCase()),m==="asc"?u>o?1:-1:u<o?1:-1}),this.orgs=e}},setup(){const e=Q(),{organisations:t}=q(e);return{useDocbitOrgStore:e,organisations:t,sub_id:a(""),org_id:a(""),search_filter:a(""),sortColumn:"",sortOrder:"",selected_org:a({}),openCreateMenu:a(!1),orgs:a([]),currentOrg:a({}),create_user:a(!1),confirmDelete:a(!1),show_subscription_menu:a(!1)}}}),Le=e=>(N("data-v-49783881"),e=e(),K(),e),Me={class:"",style:{margin:"20px"}},Ie={class:"row",style:{"margin-bottom":"10px"}},Fe=Le(()=>s("div",{class:"col-8"},null,-1)),Pe={class:"first-header-content"},ze={class:"sort-buttons"},Ae={class:"middle-header-content"},je={class:"sort-buttons"},qe={class:"middle-header-content"},Ee={class:"sort-buttons"},Ne={class:"middle-header-content"},Ke={class:"sort-buttons"},Ye={class:"middle-header-content"},Re={class:"sort-buttons"},Ge={class:"text-right table-header"},He=["onClick"],Je={class:"text-left"},We={class:"text-center"},Xe={class:"text-center"},Ze={class:"text-center"},xe={class:"text-center"},et={class:"text-right"},tt={class:"text-green-14"},st={class:"text-red-14"},ot={class:"q-ml-sm"};function lt(e,t,m,g,$,u){const o=O("CreateOrgPop"),S=O("CreateUserPop");return b(),h(D,null,[s("div",Me,[s("div",Ie,[l(p,{class:"col-3",outlined:"",dense:"",modelValue:e.search_filter,"onUpdate:modelValue":[t[0]||(t[0]=n=>e.search_filter=n),t[1]||(t[1]=n=>e.applyFilter())],debounce:"500",label:e.$t("search.organisation")},null,8,["modelValue","label"]),Fe,l(f,{class:"col-1",color:"primary",label:e.$t("create"),onClick:t[2]||(t[2]=n=>e.openCreateMenu=!0)},null,8,["label"])]),l(Y,{flat:"",class:"sticky-column-for-table q-table-seperator",style:{"max-height":"80vh",overflow:"auto"},dense:""},{default:i(()=>[s("thead",null,[s("tr",null,[s("th",null,[s("div",Pe,[c(r(e.$t("name"))+" ",1),s("div",ze,[s("button",{onClick:t[3]||(t[3]=n=>e.sortTable("name","asc")),class:d([e.getSortButtonClass("name","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[4]||(t[4]=n=>e.sortTable("name","desc")),class:d([e.getSortButtonClass("name","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",Ae,[c(r(e.$t("subscribed"))+" ",1),s("div",je,[s("button",{onClick:t[5]||(t[5]=n=>e.sortTable("subscribed","asc")),class:d([e.getSortButtonClass("subscribed","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[6]||(t[6]=n=>e.sortTable("subscribed","desc")),class:d([e.getSortButtonClass("subscribed","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",qe,[c(r(e.$t("created_on"))+" ",1),s("div",Ee,[s("button",{onClick:t[7]||(t[7]=n=>e.sortTable("created_on","desc")),class:d([e.getSortButtonClass("created_on","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[8]||(t[8]=n=>e.sortTable("created_on","asc")),class:d([e.getSortButtonClass("created_on","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",Ne,[c(r(e.$t("user"))+" ",1),s("div",Ke,[s("button",{onClick:t[9]||(t[9]=n=>e.sortTable("user","desc")),class:d([e.getSortButtonClass("user","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[10]||(t[10]=n=>e.sortTable("user","asc")),class:d([e.getSortButtonClass("user","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",Ye,[c(r(e.$t("pages"))+" ",1),s("div",Re,[s("button",{onClick:t[11]||(t[11]=n=>e.sortTable("pages","desc")),class:d([e.getSortButtonClass("pages","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[12]||(t[12]=n=>e.sortTable("pages","asc")),class:d([e.getSortButtonClass("pages","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",Ge,r(e.$t("actions")),1)])]),s("tbody",null,[(b(!0),h(D,null,E(e.orgs,n=>(b(),h("tr",{key:n,onClick:M=>e.openOrgMenu(n)},[s("td",Je,r(n.name),1),s("td",We,r(e.$t(n.subscribed)),1),s("td",Xe,r(new Date(n.created_on).toLocaleDateString()),1),s("td",Ze,r(n.user_count),1),s("td",xe,r(n.pages)+" / Year",1),s("td",et,[l(f,{flat:"",dense:"",round:"",onClick:t[13]||(t[13]=G(()=>{},["stop","prevent"])),icon:"more_horiz"},{default:i(()=>[l(H,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:i(()=>[l(J,{dense:"",style:{"min-width":"100px"}},{default:i(()=>[l(y,{inset:""}),l(F,{clickable:""},{default:i(()=>[l(P,{onClick:M=>{e.selected_org=n,e.create_user=!0}},{default:i(()=>[s("span",tt,r(e.$t("create_user")),1)]),_:2},1032,["onClick"])]),_:2},1024),l(F,{clickable:""},{default:i(()=>[l(P,{onClick:M=>{e.selected_org=n,e.confirmDelete=!0}},{default:i(()=>[s("span",st,r(e.$t("delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,He))),128))])]),_:1})]),l(T,{modelValue:e.openCreateMenu,"onUpdate:modelValue":t[14]||(t[14]=n=>e.openCreateMenu=n),onKeydown:t[15]||(t[15]=I(n=>e.openCreateMenu=!1,["esc"])),persistent:""},{default:i(()=>[l(o)]),_:1},8,["modelValue"]),l(T,{modelValue:e.create_user,"onUpdate:modelValue":t[16]||(t[16]=n=>e.create_user=n),onKeydown:t[17]||(t[17]=I(n=>e.create_user=!1,["esc"])),persistent:""},{default:i(()=>[l(S,{organisation:e.selected_org},null,8,["organisation"])]),_:1},8,["modelValue"]),l(T,{modelValue:e.confirmDelete,"onUpdate:modelValue":t[19]||(t[19]=n=>e.confirmDelete=n),persistent:""},{default:i(()=>[l(L,null,{default:i(()=>[l(_,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:i(()=>[l(R,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),l(_,{class:"row items-center"},{default:i(()=>[s("span",ot,r(e.$t("popups.msg_delete")),1)]),_:1}),l(U,{align:"right"},{default:i(()=>[v(l(f,{flat:"",label:e.$t("cancel"),color:"primary"},null,8,["label"]),[[C]]),v(l(f,{flat:"",label:e.$t("done"),color:"primary",onClick:t[18]||(t[18]=n=>e.deleteOrg())},null,8,["label"]),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var nt=B(Ue,[["render",lt],["__scopeId","data-v-49783881"]]);const rt=w({el:"#app",mixins:[V,k,z],components:{},watch:{organisations:{handler:function(e){this.orgs=e}}},mounted(){const e=this.getCurrentOrgInLocalStorage();e!=null&&(this.partner_id=e.id),this.getOrgData()},methods:{async getOrgData(){await this.useDocbitOrgStore.getOrgsFromServer("1",this.partner_id)},openOrgMenu(e){this.$router.push("/client/"+e.org_id)},applyFilter(){this.orgs=[],this.organisations.forEach(e=>{e:for(const t in e){if(e[t]==null)continue;if(e[t].toString().toLowerCase().includes(this.search_filter.toLowerCase())){this.orgs.push(e);break e}}})},sortTable(e,t){this.sortColumn=e,this.sortOrder=t,this.sortedColumns()},getSortButtonClass(e,t){return{"active-sort-button":this.sortColumn===e&&this.sortOrder===t,"sort-button":!0}},sortedColumns(){const e=this.orgs,t=this.sortColumn,m=this.sortOrder;t&&e.sort((g,$)=>{let u=g[t],o=$[t];return typeof u=="string"&&(u=u.toLowerCase()),typeof o=="string"&&(o=o.toLowerCase()),m==="asc"?u>o?1:-1:u<o?1:-1}),this.orgs=e}},setup(){const e=Q(),{organisations:t}=q(e);return{useDocbitOrgStore:e,organisations:t,sub_id:a(""),org_id:a(""),partner_id:a(""),search_filter:a(""),sortColumn:"",sortOrder:"",selected_org:a({}),openCreateMenu:a(!1),orgs:a([]),currentOrg:a({}),create_user:a(!1),confirmDelete:a(!1),show_subscription_menu:a(!1)}}}),at=e=>(N("data-v-69db2ad9"),e=e(),K(),e),it={class:"",style:{margin:"20px"}},dt={class:"row",style:{"margin-bottom":"10px"}},ut=at(()=>s("div",{class:"col-8"},null,-1)),ct={class:"first-header-content"},pt={class:"sort-buttons"},mt={class:"middle-header-content"},bt={class:"sort-buttons"},gt={class:"middle-header-content"},$t={class:"sort-buttons"},ft={class:"middle-header-content"},ht={class:"sort-buttons"},vt={class:"middle-header-content"},Ct={class:"sort-buttons"},_t=["onClick"],yt={class:"text-left"},Vt={class:"text-center"},kt={class:"text-center"},wt={class:"text-center"},Bt={class:"text-center"};function St(e,t,m,g,$,u){return b(),h("div",it,[s("div",dt,[l(p,{class:"col-3",outlined:"",dense:"",modelValue:e.search_filter,"onUpdate:modelValue":[t[0]||(t[0]=o=>e.search_filter=o),t[1]||(t[1]=o=>e.applyFilter())],debounce:"500",label:e.$t("search.organisation")},null,8,["modelValue","label"]),ut]),l(Y,{flat:"",class:"sticky-column-for-table q-table-seperator",style:{"max-height":"80vh",overflow:"auto"},dense:""},{default:i(()=>[s("thead",null,[s("tr",null,[s("th",null,[s("div",ct,[c(r(e.$t("name"))+" ",1),s("div",pt,[s("button",{onClick:t[2]||(t[2]=o=>e.sortTable("name","asc")),class:d([e.getSortButtonClass("name","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[3]||(t[3]=o=>e.sortTable("name","desc")),class:d([e.getSortButtonClass("name","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",mt,[c(r(e.$t("subscribed"))+" ",1),s("div",bt,[s("button",{onClick:t[4]||(t[4]=o=>e.sortTable("subscribed","asc")),class:d([e.getSortButtonClass("subscribed","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[5]||(t[5]=o=>e.sortTable("subscribed","desc")),class:d([e.getSortButtonClass("subscribed","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",gt,[c(r(e.$t("created_on"))+" ",1),s("div",$t,[s("button",{onClick:t[6]||(t[6]=o=>e.sortTable("created_on","desc")),class:d([e.getSortButtonClass("created_on","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[7]||(t[7]=o=>e.sortTable("created_on","asc")),class:d([e.getSortButtonClass("created_on","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",ft,[c(r(e.$t("user"))+" ",1),s("div",ht,[s("button",{onClick:t[8]||(t[8]=o=>e.sortTable("user","desc")),class:d([e.getSortButtonClass("user","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[9]||(t[9]=o=>e.sortTable("user","asc")),class:d([e.getSortButtonClass("user","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",vt,[c(r(e.$t("pages"))+" ",1),s("div",Ct,[s("button",{onClick:t[10]||(t[10]=o=>e.sortTable("pages","desc")),class:d([e.getSortButtonClass("pages","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:t[11]||(t[11]=o=>e.sortTable("pages","asc")),class:d([e.getSortButtonClass("pages","asc"),"sort-button"])}," \u25BC ",2)])])])])]),s("tbody",null,[(b(!0),h(D,null,E(e.orgs,o=>(b(),h("tr",{key:o,onClick:S=>e.openOrgMenu(o)},[s("td",yt,r(o.name),1),s("td",Vt,r(e.$t(o.subscribed)),1),s("td",kt,r(new Date(o.created_on).toLocaleDateString()),1),s("td",wt,r(o.user),1),s("td",Bt,r(o.pages)+" / Year",1)],8,_t))),128))])]),_:1})])}var Ot=B(rt,[["render",St],["__scopeId","data-v-69db2ad9"]]);const Tt=w({el:"#app",mixins:[V,k,z],components:{admin_table:nt,partner_table:Ot},mounted(){const e=this.getCurrentOrgInLocalStorage();e!=null&&(this.type=e.type)},methods:{},setup(){return{type:a("")}}}),Dt={key:0},Qt={key:1};function Ut(e,t,m,g,$,u){const o=O("admin_table"),S=O("partner_table");return e.type=="management"?(b(),h("div",Dt,[l(o)])):e.type=="partner"?(b(),h("div",Qt,[l(S)])):j("",!0)}var Kt=B(Tt,[["render",Ut]]);export{Kt as default};
