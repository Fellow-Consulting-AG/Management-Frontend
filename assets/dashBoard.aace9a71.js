import{Q as $}from"./QInput.3689943e.js";import{Q as w,a as B,b as k}from"./QMenu.9bd878e0.js";import{Q as S}from"./QList.1d59738b.js";import{_ as Q,d as U,aE as D,r as n,m,n as c,p as s,f as r,s as l,u as V,F as C,y as f,z as a,au as d,at as T,aw as I,ap as _,x as p,A as M,B as F,ax as L}from"./index.d19697de.js";import{Q as O}from"./QMarkupTable.0e911f1b.js";import{a as j,Q as z,b as v}from"./QDialog.33d18147.js";import{g as A,Q as E}from"./dashBoardStore.44c22ed6.js";import{C as g}from"./ClosePopup.cd6faefe.js";import{t as N,h as q}from"./helperMixin.e09d473f.js";import"./focusout.fed31c9b.js";import"./axios.ab682c6b.js";const K=U({el:"#app",mixins:[N,q],watch:{user_list:{handler:function(t){this.users=t}}},mounted(){this.getUserData()},methods:{async getUserData(){await this.useDocbitUserStore.getUsersFromServer("all")},openUserMenu(t){this.$router.push("/user/"+t.id)},async deleteUser(){await this.useDocbitUserStore.deleteUser(this.selected_user),this.applyFilter()},applyFilter(){this.users=[],this.user_list.forEach(t=>{t:for(const e in t){if(t[e]==null)continue;if(t[e].toString().toLowerCase().includes(this.search_filter.toLowerCase())){this.users.push(t);break t}}})},sortTable(t,e){this.sortColumn=t,this.sortOrder=e,this.sortedColumns()},getSortButtonClass(t,e){return{"active-sort-button":this.sortColumn===t&&this.sortOrder===e,"sort-button":!0}},sortedColumns(){const t=this.users,e=this.sortColumn,u=this.sortOrder;e&&t.sort((h,b)=>{let i=h[e],o=b[e];return typeof i=="string"&&(i=i.toLowerCase()),typeof o=="string"&&(o=o.toLowerCase()),u==="asc"?i>o?1:-1:i<o?1:-1}),this.users=t}},setup(){const t=A(),{user_list:e}=D(t);return{useDocbitUserStore:t,user_list:e,user_id:n(""),search_filter:n(""),sortColumn:"",sortOrder:"",selected_user:n({}),openCreateMenu:n(!1),users:n([]),currentUser:n({}),create_user:n(!1),confirmDelete:n(!1)}}}),P=t=>(M("data-v-5f3f351c"),t=t(),F(),t),R={class:"",style:{margin:"20px"}},G={class:"row",style:{"margin-bottom":"10px"}},H=P(()=>s("div",{class:"col-8"},null,-1)),J={class:"first-header-content"},W={class:"sort-buttons"},X={class:"middle-header-content"},Y={class:"sort-buttons"},Z={class:"middle-header-content"},x={class:"sort-buttons"},tt={class:"text-right table-header"},et=["onClick"],st={class:"text-left"},ot={class:"text-center"},rt={class:"text-center"},lt={class:"text-right"},at={class:"text-red-14"},nt={class:"q-ml-sm"};function it(t,e,u,h,b,i){return m(),c(C,null,[s("div",R,[s("div",G,[r($,{class:"col-3",outlined:"",dense:"",modelValue:t.search_filter,"onUpdate:modelValue":[e[0]||(e[0]=o=>t.search_filter=o),e[1]||(e[1]=o=>t.applyFilter())],debounce:"500",label:t.$t("search.user")},null,8,["modelValue","label"]),H]),r(O,{flat:"",class:"sticky-column-for-table q-table-seperator",style:{"max-height":"80vh",overflow:"auto"},dense:""},{default:l(()=>[s("thead",null,[s("tr",null,[s("th",null,[s("div",J,[f(a(t.$t("first_name"))+" ",1),s("div",W,[s("button",{onClick:e[2]||(e[2]=o=>t.sortTable("first_name","asc")),class:d([t.getSortButtonClass("first_name","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:e[3]||(e[3]=o=>t.sortTable("first_name","desc")),class:d([t.getSortButtonClass("first_name","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",X,[f(a(t.$t("last_name"))+" ",1),s("div",Y,[s("button",{onClick:e[4]||(e[4]=o=>t.sortTable("last_name","asc")),class:d([t.getSortButtonClass("last_name","asc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:e[5]||(e[5]=o=>t.sortTable("last_name","desc")),class:d([t.getSortButtonClass("last_name","desc"),"sort-button"])}," \u25BC ",2)])])]),s("th",null,[s("div",Z,[f(a(t.$t("email"))+" ",1),s("div",x,[s("button",{onClick:e[6]||(e[6]=o=>t.sortTable("email","desc")),class:d([t.getSortButtonClass("email","desc"),"sort-button"])}," \u25B2 ",2),s("button",{onClick:e[7]||(e[7]=o=>t.sortTable("email","asc")),class:d([t.getSortButtonClass("email","asc"),"sort-button"])}," \u25BC ",2)])])]),s("th",tt,a(t.$t("actions")),1)])]),s("tbody",null,[(m(!0),c(C,null,T(t.users,o=>(m(),c("tr",{key:o,onClick:y=>t.openUserMenu(o)},[s("td",st,a(o.first_name),1),s("td",ot,a(o.last_name),1),s("td",rt,a(o.email),1),s("td",lt,[r(p,{flat:"",dense:"",round:"",onClick:e[8]||(e[8]=L(()=>{},["stop","prevent"])),icon:"more_horiz"},{default:l(()=>[r(w,{"auto-close":"","transition-show":"jump-down","transition-hide":"jump-up",anchor:"bottom middle",self:"top middle"},{default:l(()=>[r(S,{dense:"",style:{"min-width":"100px"}},{default:l(()=>[r(B,{clickable:""},{default:l(()=>[r(k,{onClick:y=>{t.selected_user=o,t.confirmDelete=!0}},{default:l(()=>[s("span",at,a(t.$t("delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,et))),128))])]),_:1})]),r(j,{modelValue:t.confirmDelete,"onUpdate:modelValue":e[10]||(e[10]=o=>t.confirmDelete=o),persistent:"",onKeypress:e[11]||(e[11]=V(o=>(t.deleteUser(),t.confirmDelete=!1),["enter"]))},{default:l(()=>[r(z,null,{default:l(()=>[r(v,{class:"row",style:{"justify-content":"center",display:"flex"}},{default:l(()=>[r(I,{icon:"warning",color:"primary","text-color":"white"})]),_:1}),r(v,{class:"row items-center"},{default:l(()=>[s("span",nt,a(t.$t("popups.msg_delete")),1)]),_:1}),r(E,{align:"center"},{default:l(()=>[_(r(p,{flat:"",label:t.$t("cancel"),color:"primary"},null,8,["label"]),[[g]]),_(r(p,{flat:"",label:t.$t("done"),color:"primary",onClick:e[9]||(e[9]=o=>t.deleteUser())},null,8,["label"]),[[g]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var gt=Q(K,[["render",it],["__scopeId","data-v-5f3f351c"]]);export{gt as default};
