(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{530:(e,n,t)=>{"use strict";function r(e){console.log("Orgs",e);let n=[];return n.push(...e.map(e=>({id:e.org_id,name:e.name}))),n}t.d(n,{n:()=>r})},1567:(e,n,t)=>{"use strict";function r(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"de-DE";return new Date(e).toLocaleString(n)}function a(e){let n=new Date,t=new Date;return t.setDate(n.getDate()-e),{start:t.toISOString().split("T")[0],end:n.toISOString().split("T")[0]}}function s(e,n){let t=e[n];return null==t||"null"===t?"":t}t.d(n,{Tl:()=>s,Yq:()=>r,uo:()=>a})},2336:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>P});var r=t(5155),a=t(6646),s=t(5169),l=t(1401),i=t(382),c=t(1567),d=t(2914);function u(e){let{data:n=[]}=e;return n?(0,r.jsxs)(i.bL,{children:[(0,r.jsx)(i.Y9,{children:(0,r.jsx)(i.fI,{children:[{id:"name",label:"Name"},{id:"created_on",label:"Created on"}].map(e=>(0,r.jsx)(i.Oh,{children:e.label},e.id))})}),(0,r.jsx)(i.nB,{children:n.map(e=>(0,r.jsxs)(i.fI,{children:[(0,r.jsx)(i.fh,{children:e.name}),(0,r.jsx)(i.fh,{children:(0,c.Yq)(e.created_on)})]},e.id))})]}):(0,r.jsx)(d.A,{})}var o=t(3071),h=t(1821),x=t(648);function j(e){let{data:n}=e;return(0,r.jsx)(o.Z,{size:"2",children:(0,r.jsxs)(a.s,{direction:"column",gap:"3",children:[(0,r.jsx)(s.D,{as:"h3",mb:"4",color:"blue",children:(0,r.jsxs)(a.s,{direction:"row",gap:"2",align:"center",children:[(0,r.jsx)(x._lE,{}),"New Clients",(0,r.jsx)(h.$,{size:"1",variant:"outline",children:"Show All"})]})}),(0,r.jsx)(u,{data:n})]})})}function f(e){let{data:n=[]}=e;return 0===n.length?(0,r.jsx)(d.A,{}):(0,r.jsxs)(i.bL,{children:[(0,r.jsx)(i.Y9,{children:(0,r.jsx)(i.fI,{children:[{id:"rank",label:"Rank"},{id:"name",label:"Name"},{id:"hits",label:"Hits"}].map(e=>(0,r.jsx)(i.Oh,{children:e.label},e.id))})}),(0,r.jsx)(i.nB,{children:n.map((e,n)=>(0,r.jsxs)(i.fI,{children:[(0,r.jsx)(i.fh,{className:function(e){switch(e){case 1:return"text-green-500 bold-font";case 2:return"text-yellow-500 bold-font";case 3:return"text-red-500 bold-font";default:return""}}(n+1),children:n+1}),(0,r.jsx)(i.fh,{children:e.name}),(0,r.jsx)(i.fh,{children:Math.round(parseInt(e.hits))})]},n))})]})}var g=t(3970);function m(e){let{data:n}=e;return(0,r.jsx)(o.Z,{size:"2",children:(0,r.jsxs)(a.s,{direction:"column",gap:"3",children:[(0,r.jsx)(s.D,{as:"h3",mb:"4",color:"blue",children:(0,r.jsxs)(a.s,{direction:"row",gap:"2",align:"center",children:[(0,r.jsx)(g.wO6,{}),"Top Clients"]})}),(0,r.jsx)(f,{data:n})]})})}var v=t(2115);let p=(0,t(9827).v)(e=>({data:null,setData:n=>e({data:n})}));var b=t(6838),y=t(9476),w=t(530),_=t(7453),L=t(1497),D=t(2647),I=t(8435);function N(e){let{onCustomerSelect:n}=e,t=(0,I.od)();return(0,r.jsxs)(D.Root,{defaultValue:t[0].id,onValueChange:e=>n(e),children:[(0,r.jsx)(D.Trigger,{}),(0,r.jsx)(D.Content,{children:(0,r.jsx)(D.Group,{children:t.map(e=>(0,r.jsx)(D.Item,{value:e.id,children:e.name},e.id))})})]})}function k(e){let{onDateSelect:n}=e,t=[{label:"Last 7 days",value:"7"},{label:"Last 30 days",value:"30"},{label:"Last 90 days",value:"90"},{label:"Last 180 days",value:"180"},{label:"Last 365 days",value:"365"}];return(0,r.jsxs)(D.Root,{defaultValue:t[1].value,onValueChange:e=>n(e),children:[(0,r.jsx)(D.Trigger,{}),(0,r.jsx)(D.Content,{children:(0,r.jsx)(D.Group,{children:t.map(e=>(0,r.jsx)(D.Item,{value:e.value,children:e.label},e.value))})})]})}var C=t(9719),E=t(7922),S=t(7808);function M(e){let{data:n}=e,t=(0,L.c3)("DataAnalysisCard");if(!n)return(0,r.jsx)(S.A,{visible:!0,message:t("no_data")});var s=n.used/n.total*100;return(0,r.jsxs)(a.s,{direction:"column",gap:"3",align:"center",children:[(0,r.jsxs)(a.s,{direction:"row",gap:"1",align:"baseline",children:[(0,r.jsxs)(C.E,{size:"8",weight:"bold",children:[s.toFixed(2),"%"]}),(0,r.jsx)(C.E,{color:"gray",size:"2",children:t("of_tokens_used")})]}),(0,r.jsx)(E.k,{color:s>100?"red":"blue",value:Math.floor(s),max:Math.floor(s)>100?Math.floor(s):100,size:"3",className:"w-full"})]})}function O(e){let{data:n,customers:t,onUpdate:l}=e,i=(0,L.c3)("DataAnalysisCard"),[c,u]=(0,v.useState)(30),[h,j]=(0,v.useState)("");return(0,r.jsx)(o.Z,{size:"2",children:(0,r.jsxs)(a.s,{direction:"column",gap:"3",children:[(0,r.jsx)(s.D,{as:"h3",mb:"4",color:"blue",children:(0,r.jsxs)(a.s,{direction:"row",gap:"2",align:"center",children:[(0,r.jsx)(x.gLv,{}),i("title")]})}),t?(0,r.jsxs)(a.s,{direction:"column",gap:"4",children:[(0,r.jsx)(N,{onCustomerSelect:function(e){j(e),l(e,c)}}),(0,r.jsx)(k,{onDateSelect:function(e){u(parseInt(e)),l(h,parseInt(e))}}),(0,r.jsx)(_.a,{className:"pt-10",children:(0,r.jsx)(M,{data:n})})]}):(0,r.jsx)(d.A,{})]})})}function P(){var e;let{data:n,setData:t}=p(),{orgs:i,setOrgs:d}=(0,b.L)(),{customers:u,setCustomers:o}=(0,y.N)(),h=async function(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null==u?void 0:null===(e=u[0])||void 0===e?void 0:e.id;if(!u||0===u.length)return;let{start:a,end:s}=(0,c.uo)(n);await fetch("api/dashboard",{method:"POST",body:JSON.stringify({activity_start_date:a,activity_end_date:s,data_org:r,data_start_date:a,data_end_date:s})}).then(async e=>{e.ok&&t(await e.json())})},x=async()=>{await fetch("api/organisations",{method:"GET"}).then(async e=>{if(e.ok){let n=await e.json();d(Object.keys(n).map(e=>({...n[e]})))}})},f=async(e,n)=>{await h(n,e)};return(0,v.useEffect)(()=>{!i&&x()},[]),(0,v.useEffect)(()=>{!u&&i&&o((0,w.n)(i))},[i]),(0,v.useEffect)(()=>{!n&&u&&h()},[u]),(0,r.jsxs)(a.s,{direction:"column",gap:"6",className:"dashboard",children:[(0,r.jsx)(s.D,{size:"8",children:"Dashboard"}),(0,r.jsxs)(a.s,{direction:"column",gap:"4",justify:"center",children:[(0,r.jsxs)(l.x,{gap:"3",columns:{initial:"1",lg:"2"},children:[(0,r.jsx)(j,{data:null==n?void 0:n.new_clients}),(0,r.jsx)(O,{onUpdate:f,data:(null==n?void 0:null===(e=n.data_analysis)||void 0===e?void 0:e[0])||void 0,customers:u||void 0})]}),(0,r.jsx)(l.x,{gap:"3",columns:"1",children:(0,r.jsx)(m,{data:null==n?void 0:n.top_clients})})]})]})}},2914:(e,n,t)=>{"use strict";t.d(n,{A:()=>l});var r=t(5155),a=t(6646),s=t(9499);function l(){return(0,r.jsx)(a.s,{align:"center",justify:"center",children:(0,r.jsx)(s.y,{size:"3"})})}},6838:(e,n,t)=>{"use strict";t.d(n,{L:()=>r});let r=(0,t(9827).v)(e=>({orgs:null,setOrgs:n=>e({orgs:n})}))},7808:(e,n,t)=>{"use strict";t.d(n,{A:()=>l});var r=t(5155),a=t(4813),s=t(7365);function l(e){let{visible:n,message:t}=e;return n?(0,r.jsxs)(a.Root,{color:"red",size:"2",children:[(0,r.jsx)(a.Icon,{children:(0,r.jsx)(s.raE,{})}),(0,r.jsx)(a.Text,{children:t||"Error! Please try again."})]}):null}},8435:(e,n,t)=>{"use strict";t.d(n,{fY:()=>l,od:()=>a,qj:()=>s});var r=t(9476);function a(){let{customers:e}=r.N.getState();return e||[]}function s(e){if(!e)return"Interessent";switch(e){case 1:return"Kunde";case 2:return"Lieferant";case 3:return"Kunde & Lieferant";case 4:return"Management";case 5:return"Kunde & Management";case 6:return"Lieferant & Management";case 7:return"Kunde & Lieferant & Management";case 8:return"Partner";case 9:return"Kunde & Partner";case 10:return"Lieferant & Partner";case 11:return"Kunde & Lieferant & Partner";case 12:return"Management & Partner";case 13:return"Kunde & Management & Partner";case 14:return"Lieferant & Management & Partner";case 15:return"Kunde & Lieferant & Management & Partner";case 16:return"Interest"}}function l(e){if(!e)return"blue";switch(e){case 1:return"green";case 2:return"yellow";case 3:return"red";case 4:return"purple";case 5:return"pink";case 6:return"orange";case 7:return"teal";case 8:return"gray";case 9:return"indigo";case 10:return"lime";case 11:return"cyan";case 12:return"sky";case 13:return"grass";case 14:return"crimson";case 15:return"violet";case 16:return"blue"}}},9130:(e,n,t)=>{Promise.resolve().then(t.bind(t,2336))},9476:(e,n,t)=>{"use strict";t.d(n,{N:()=>r});let r=(0,t(9827).v)(e=>({customers:null,setCustomers:n=>e({customers:n})}))}},e=>{var n=n=>e(e.s=n);e.O(0,[105,479,446,209,296,654,435,441,587,358],()=>n(9130)),_N_E=e.O()}]);