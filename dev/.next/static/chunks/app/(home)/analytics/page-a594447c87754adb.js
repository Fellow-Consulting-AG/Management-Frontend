(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{382:(e,t,r)=>{"use strict";r.d(t,{nB:()=>y,fh:()=>g,Oh:()=>j,Y9:()=>p,bL:()=>h,fI:()=>b});var a=r(2115),s=r(4617),l=r(9444),n=r(4777);let i={size:{type:"enum",className:"rt-r-size",values:["1","2","3"],default:"2",responsive:!0},variant:{type:"enum",className:"rt-variant",values:["surface","ghost"],default:"ghost"},layout:{type:"enum",className:"rt-r-tl",values:["auto","fixed"],responsive:!0}},c={align:{type:"enum",className:"rt-r-va",values:["start","center","end","baseline"],parseValue:function(e){return({baseline:"baseline",start:"top",center:"middle",end:"bottom"})[e]},responsive:!0}},o={justify:{type:"enum",className:"rt-r-ta",values:["start","center","end"],parseValue:function(e){return({start:"left",center:"center",end:"right"})[e]},responsive:!0},...n.w,...l.T};var u=r(3984),d=r(4830),f=r(8581),m=r(652);let h=a.forwardRef((e,t)=>{let{layout:r,...l}=i,{className:n,children:c,layout:o,...h}=(0,u.o)(e,l,f.y),p=(0,d.J_)({value:o,className:i.layout.className,propValues:i.layout.values});return a.createElement("div",{ref:t,className:s("rt-TableRoot",n),...h},a.createElement(m.F,null,a.createElement("table",{className:s("rt-TableRootTable",p)},c)))});h.displayName="Table.Root";let p=a.forwardRef(({className:e,...t},r)=>a.createElement("thead",{...t,ref:r,className:s("rt-TableHeader",e)}));p.displayName="Table.Header";let y=a.forwardRef(({className:e,...t},r)=>a.createElement("tbody",{...t,ref:r,className:s("rt-TableBody",e)}));y.displayName="Table.Body";let b=a.forwardRef((e,t)=>{let{className:r,...l}=(0,u.o)(e,c);return a.createElement("tr",{...l,ref:t,className:s("rt-TableRow",r)})});b.displayName="Table.Row";let g=a.forwardRef((e,t)=>{let{className:r,...l}=(0,u.o)(e,o);return a.createElement("td",{className:s("rt-TableCell",r),ref:t,...l})});g.displayName="Table.Cell";let j=a.forwardRef((e,t)=>{let{className:r,...l}=(0,u.o)(e,o);return a.createElement("th",{className:s("rt-TableCell","rt-TableColumnHeaderCell",r),scope:"col",ref:t,...l})});j.displayName="Table.ColumnHeaderCell",a.forwardRef((e,t)=>{let{className:r,...l}=(0,u.o)(e,o);return a.createElement("th",{className:s("rt-TableCell","rt-TableRowHeaderCell",r),scope:"row",ref:t,...l})}).displayName="Table.RowHeaderCell"},530:(e,t,r)=>{"use strict";function a(e){console.log("Orgs",e);let t=[];return t.push(...e.map(e=>({id:e.org_id,name:e.name}))),t}r.d(t,{n:()=>a})},1497:(e,t,r)=>{"use strict";r.d(t,{c3:()=>l});var a=r(4273);function s(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let l=s(0,a.c3);s(0,a.kc)},1522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var a=r(5155),s=r(6646),l=r(5169),n=r(2115),i=r(3071),c=r(7453),o=r(9719),u=r(2647),d=r(1821),f=r(382),m=r(1497),h=r(648),p=r(9476),y=r(6838),b=r(530),g=r(2914);let j=["January","February","March","April","May","June","July","August","September","October","November","December"],v=new Date().getFullYear(),x=Array.from({length:5},(e,t)=>v-t);function N(){let e=(0,m.c3)("OrganizationUsageReport"),{customers:t,setCustomers:r}=(0,p.N)(),{orgs:N}=(0,y.L)(),[O,w]=(0,n.useState)(""),[E,C]=(0,n.useState)(v),[S,T]=(0,n.useState)([]),[_,R]=(0,n.useState)(!1);(0,n.useEffect)(()=>{!t&&N&&r((0,b.n)(N))},[N,t,r]),(0,n.useEffect)(()=>{t&&t.length>0&&!O&&w(t[0].id)},[t,O]);let P=async()=>{if(O&&E){R(!0);try{let e=await fetch("/api/analytics/usage-statistics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({org_id:O,year:E,group_by:"month"})});if(e.ok){let t=await e.json();T(t.monthly_usage||[])}}catch(e){console.error("Failed to fetch usage data:",e)}finally{R(!1)}}},z=e=>S.find(t=>t.month===e&&t.year===E);return(0,a.jsx)(i.Z,{size:"3",children:(0,a.jsxs)(s.s,{direction:"column",gap:"4",children:[(0,a.jsx)(l.D,{as:"h3",mb:"2",color:"blue",children:(0,a.jsxs)(s.s,{direction:"row",gap:"2",align:"center",children:[(0,a.jsx)(h.gLv,{}),e("title")]})}),t?(0,a.jsxs)(s.s,{direction:"column",gap:"4",children:[(0,a.jsxs)(s.s,{direction:"row",gap:"3",align:"center",wrap:"wrap",children:[(0,a.jsxs)(c.a,{children:[(0,a.jsxs)(o.E,{size:"2",weight:"bold",children:[e("organization"),":"]}),(0,a.jsxs)(u.Root,{value:O,onValueChange:w,children:[(0,a.jsx)(u.Trigger,{}),(0,a.jsx)(u.Content,{children:t.map(e=>(0,a.jsx)(u.Item,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)(c.a,{children:[(0,a.jsxs)(o.E,{size:"2",weight:"bold",children:[e("year"),":"]}),(0,a.jsxs)(u.Root,{value:E.toString(),onValueChange:e=>C(parseInt(e)),children:[(0,a.jsx)(u.Trigger,{}),(0,a.jsx)(u.Content,{children:x.map(e=>(0,a.jsx)(u.Item,{value:e.toString(),children:e},e))})]})]}),(0,a.jsx)(d.$,{onClick:()=>{P()},disabled:_,children:e(_?"loading":"generate_report")})]}),S.length>0&&(0,a.jsxs)(s.s,{direction:"column",gap:"3",children:[(0,a.jsxs)(s.s,{justify:"between",align:"center",children:[(0,a.jsxs)(l.D,{size:"4",children:[e("monthly_summary")," ",E]}),(0,a.jsxs)(o.E,{size:"3",weight:"bold",children:[e("total_credits"),": ",S.reduce((e,t)=>e+t.total_credits,0).toLocaleString()]})]}),(0,a.jsxs)(f.bL,{children:[(0,a.jsx)(f.Y9,{children:(0,a.jsxs)(f.fI,{children:[(0,a.jsx)(f.Oh,{children:e("month")}),(0,a.jsx)(f.Oh,{children:e("regular_credits")}),(0,a.jsx)(f.Oh,{children:e("classification_credits")}),(0,a.jsx)(f.Oh,{children:e("total")})]})}),(0,a.jsx)(f.nB,{children:j.map((e,t)=>{let r=z(t+1),s=(null==r?void 0:r.credit_used)||0,l=(null==r?void 0:r.classification_credit_used)||0,n=s+l;return(0,a.jsxs)(f.fI,{children:[(0,a.jsx)(f.fh,{children:e}),(0,a.jsx)(f.fh,{children:s.toLocaleString()}),(0,a.jsx)(f.fh,{children:l.toLocaleString()}),(0,a.jsx)(f.fh,{children:(0,a.jsx)("strong",{children:n.toLocaleString()})})]},e)})})]})]}),!_&&0===S.length&&O&&(0,a.jsx)(s.s,{justify:"center",py:"6",children:(0,a.jsx)(o.E,{color:"gray",children:e("no_data")})}),_&&(0,a.jsx)(s.s,{justify:"center",py:"6",children:(0,a.jsx)(g.A,{})})]}):(0,a.jsx)(g.A,{})]})})}function O(){return(0,a.jsxs)(s.s,{direction:"column",gap:"6",className:"analytics",children:[(0,a.jsx)(l.D,{size:"8",children:"Analytics"}),(0,a.jsx)(s.s,{direction:"column",gap:"4",justify:"center",children:(0,a.jsx)(N,{})})]})}},2914:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(5155),s=r(6646),l=r(9499);function n(){return(0,a.jsx)(s.s,{align:"center",justify:"center",children:(0,a.jsx)(l.y,{size:"3"})})}},3071:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(2115),s=r(4617),l=r(2317);let n={...r(7847).f,size:{type:"enum",className:"rt-r-size",values:["1","2","3","4","5"],default:"1",responsive:!0},variant:{type:"enum",className:"rt-variant",values:["surface","classic","ghost"],default:"surface"}};var i=r(3984),c=r(8581);let o=a.forwardRef((e,t)=>{let{asChild:r,className:o,...u}=(0,i.o)(e,n,c.y),d=r?l.bL:"div";return a.createElement(d,{ref:t,...u,className:s("rt-reset","rt-BaseCard","rt-Card",o)})});o.displayName="Card"},3435:(e,t,r)=>{"use strict";r.d(t,{k5:()=>u});var a=r(2115),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=a.createContext&&a.createContext(s),n=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var a,s,l;a=e,s=t,l=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>a.createElement(d,i({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,o({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:s,size:l,title:c}=e,u=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,n),d=l||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,u,{className:r,style:o(o({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),c&&a.createElement("title",null,c),e.children)};return void 0!==l?a.createElement(l.Consumer,null,e=>t(e)):t(s)}},6838:(e,t,r)=>{"use strict";r.d(t,{L:()=>a});let a=(0,r(9827).v)(e=>({orgs:null,setOrgs:t=>e({orgs:t})}))},9476:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(9827).v)(e=>({customers:null,setCustomers:t=>e({customers:t})}))},9650:(e,t,r)=>{Promise.resolve().then(r.bind(r,1522))},9827:(e,t,r)=>{"use strict";r.d(t,{v:()=>c});var a=r(2115);let s=e=>{let t;let r=new Set,a=(e,a)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=a?a:"object"!=typeof s||null===s)?s:Object.assign({},t,s),r.forEach(r=>r(t,e))}},s=()=>t,l={setState:a,getState:s,getInitialState:()=>n,subscribe:e=>(r.add(e),()=>r.delete(e))},n=t=e(a,s,l);return l},l=e=>e?s(e):s,n=e=>e,i=e=>{let t=l(e),r=e=>(function(e,t=n){let r=a.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},c=e=>e?i(e):i}},e=>{var t=t=>e(e.s=t);e.O(0,[479,209,296,654,441,587,358],()=>t(9650)),_N_E=e.O()}]);